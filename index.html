<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FinSignal 2.0 â€” FÄ±rsat YakalayÄ±cÄ±</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,400&family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0a0e17;--bg2:#0f1520;--panel:#111827;--panel2:#161e2e;
  --border:rgba(255,255,255,.07);--border2:rgba(255,255,255,.12);
  --buy:#00e676;--sell:#ff4458;--hold:#ffb300;--accent:#4f8ef7;--purple:#a855f7;
  --text:#e8edf5;--muted:#64748b;--muted2:#94a3b8;
  --font:'Syne',sans-serif;--mono:'DM Mono',monospace;
  --glow-buy:rgba(0,230,118,.15);--glow-sell:rgba(255,68,88,.15);--glow-accent:rgba(79,142,247,.15);
}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:var(--font);min-height:100vh;overflow-x:hidden;font-size:14px}
body::before{content:'';position:fixed;inset:0;background:
  radial-gradient(ellipse 60% 40% at 10% 10%,rgba(79,142,247,.06) 0%,transparent 60%),
  radial-gradient(ellipse 40% 50% at 90% 80%,rgba(168,85,247,.05) 0%,transparent 60%),
  radial-gradient(ellipse 80% 30% at 50% 50%,rgba(0,230,118,.02) 0%,transparent 70%);
  pointer-events:none;z-index:0}

/* SCROLLBAR */
::-webkit-scrollbar{width:4px;height:4px}
::-webkit-scrollbar-track{background:var(--bg)}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px}

/* HEADER */
.header{display:flex;align-items:center;justify-content:space-between;padding:14px 24px;border-bottom:1px solid var(--border);background:rgba(10,14,23,.95);backdrop-filter:blur(20px);position:sticky;top:0;z-index:100}
.logo{display:flex;align-items:center;gap:12px}
.logo-icon{width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--purple));display:flex;align-items:center;justify-content:center;font-size:18px;box-shadow:0 0 20px rgba(79,142,247,.4)}
.logo-text{font-size:17px;font-weight:800;letter-spacing:-1px;color:var(--text)}
.logo-text span{color:var(--accent)}
.logo-sub{font-size:9px;color:var(--muted);font-family:var(--mono);letter-spacing:2px;text-transform:uppercase;margin-top:1px}
.hstats{display:flex;gap:24px;align-items:center}
.hstat{text-align:right;cursor:default}
.hstat-val{font-family:var(--mono);font-size:13px;font-weight:500;letter-spacing:.5px}
.hstat-lbl{font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:1.5px;margin-top:2px}
.live-badge{display:flex;align-items:center;gap:6px;background:rgba(0,230,118,.08);border:1px solid rgba(0,230,118,.2);padding:5px 14px;border-radius:20px;font-family:var(--mono);font-size:10px;color:var(--buy);letter-spacing:.5px}
.dot{width:5px;height:5px;background:var(--buy);border-radius:50%;animation:pulse 1.5s infinite;box-shadow:0 0 6px var(--buy)}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.8)}}

/* TICKER */
.ticker-wrap{background:rgba(15,21,32,.98);border-bottom:1px solid var(--border);overflow:hidden;padding:7px 0}
.ticker-track{display:flex;gap:40px;animation:scroll 50s linear infinite;white-space:nowrap}
@keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
.tick{display:inline-flex;align-items:center;gap:8px;font-family:var(--mono);font-size:12px}
.tick-sym{color:var(--text);font-weight:500}
.tick-price{color:var(--muted2)}
.up{color:var(--buy)}.dn{color:var(--sell)}.nt{color:var(--hold)}
.tick-sep{color:var(--border2);font-size:16px}

/* TABS */
.tabs-wrap{background:var(--bg2);border-bottom:1px solid var(--border);position:sticky;top:67px;z-index:90}
.tabs{display:flex;gap:0;padding:0 24px;max-width:1600px;margin:0 auto}
.tab{padding:12px 20px;font-size:12px;font-weight:600;cursor:pointer;border:none;color:var(--muted);background:transparent;transition:all .2s;font-family:var(--font);letter-spacing:.3px;border-bottom:2px solid transparent;position:relative}
.tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.tab:hover:not(.active){color:var(--muted2)}
.tab-content{display:none}
.tab-content.active{display:block}

/* WRAP */
.wrap{max-width:1600px;margin:0 auto;padding:0 24px;position:relative;z-index:1}

/* GRID */
.g5{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;padding:16px 0 12px}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.gmain{display:grid;grid-template-columns:1fr 340px;gap:12px}
@media(max-width:1100px){.gmain{grid-template-columns:1fr}.g5{grid-template-columns:repeat(3,1fr)}.g3{grid-template-columns:1fr 1fr}}
@media(max-width:700px){.g5{grid-template-columns:1fr 1fr}.g3,.g2,.g4{grid-template-columns:1fr}}

/* CARD */
.card{background:var(--panel);border:1px solid var(--border);border-radius:12px;overflow:hidden;transition:border-color .2s}
.card:hover{border-color:var(--border2)}
.chead{padding:12px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.ctitle{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:2px;color:var(--muted)}
.cbadge{font-family:var(--mono);font-size:9px;background:var(--bg2);border:1px solid var(--border);padding:2px 8px;border-radius:4px;color:var(--muted)}
.snote{padding:10px 16px;font-size:10px;color:var(--muted);font-family:var(--mono);border-top:1px solid var(--border);background:var(--panel2)}

/* KPI */
.kpi{padding:16px}
.kpi-lbl{font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;font-family:var(--mono);margin-bottom:8px}
.kpi-val{font-size:28px;font-weight:800;line-height:1;margin-bottom:4px;font-family:var(--font)}
.kpi-sub{font-size:10px;color:var(--muted2);font-family:var(--mono)}
.gauge-track{height:6px;background:linear-gradient(90deg,var(--sell),var(--hold),var(--buy));border-radius:3px;position:relative;margin:10px 0 4px;opacity:.7}
.gauge-needle{position:absolute;top:-5px;width:3px;height:16px;background:white;border-radius:2px;transform:translateX(-50%);box-shadow:0 0 8px rgba(255,255,255,.6);transition:left 1.5s cubic-bezier(.34,1.56,.64,1)}

/* OPPORTUNITY CARD */
.opp-card{padding:16px;border-bottom:1px solid var(--border);transition:background .15s;cursor:default}
.opp-card:hover{background:var(--panel2)}
.opp-card:last-child{border-bottom:none}
.opp-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
.opp-asset{font-size:18px;font-weight:800;font-family:var(--font);letter-spacing:-1px}
.opp-score{display:flex;flex-direction:column;align-items:flex-end;gap:3px}
.score-bar{display:flex;gap:2px}
.score-dot{width:8px;height:8px;border-radius:2px;background:var(--border2)}
.score-dot.filled{background:var(--accent)}
.score-dot.filled.high{background:var(--buy)}
.opp-pattern{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:4px;font-family:var(--mono);font-size:9px;font-weight:700;letter-spacing:1px;background:var(--glow-accent);border:1px solid rgba(79,142,247,.3);color:var(--accent);margin-bottom:8px}
.opp-text{font-size:12px;color:var(--muted2);line-height:1.6;margin-bottom:10px}
.opp-targets{display:flex;gap:6px;flex-wrap:wrap}
.tbox{padding:6px 10px;border-radius:6px;font-family:var(--mono);font-size:10px;min-width:70px}
.tbox-entry{background:var(--glow-accent);border:1px solid rgba(79,142,247,.25)}
.tbox-target{background:var(--glow-buy);border:1px solid rgba(0,230,118,.25)}
.tbox-stop{background:var(--glow-sell);border:1px solid rgba(255,68,88,.25)}
.tbox-lbl{font-size:8px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:2px}
.tbox-val{font-weight:500;color:var(--text);font-size:11px}
.opp-footer{display:flex;align-items:center;justify-content:space-between;margin-top:10px;flex-wrap:wrap;gap:6px}
.opp-meta{font-family:var(--mono);font-size:9px;color:var(--muted)}
.opp-amount{font-family:var(--mono);font-size:11px;font-weight:500;padding:3px 10px;border-radius:4px;background:rgba(79,142,247,.1);border:1px solid rgba(79,142,247,.2);color:var(--accent)}

/* TAG */
.tag{display:inline-flex;align-items:center;gap:3px;padding:2px 8px;border-radius:4px;font-size:9px;font-family:var(--mono);font-weight:700;text-transform:uppercase;letter-spacing:.5px}
.tag-buy{background:var(--glow-buy);color:var(--buy);border:1px solid rgba(0,230,118,.3)}
.tag-sell{background:var(--glow-sell);color:var(--sell);border:1px solid rgba(255,68,88,.3)}
.tag-hold{background:rgba(255,179,0,.1);color:var(--hold);border:1px solid rgba(255,179,0,.3)}
.tag-watch{background:var(--glow-accent);color:var(--accent);border:1px solid rgba(79,142,247,.3)}

/* WATCHLIST */
.watch-item{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.watch-item:last-child{border-bottom:none}
.watch-asset{font-size:15px;font-weight:700;font-family:var(--mono)}
.watch-reason{font-size:11px;color:var(--muted2);margin-top:2px}
.watch-trigger{font-family:var(--mono);font-size:11px;color:var(--hold);background:rgba(255,179,0,.08);border:1px solid rgba(255,179,0,.2);padding:4px 10px;border-radius:4px}

/* PORTFOLIO */
.pf-stat{padding:16px;border-bottom:1px solid var(--border)}
.pf-stat:last-child{border-bottom:none}
.pf-val{font-size:32px;font-weight:800;font-family:var(--mono);line-height:1}
.pf-lbl{font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;margin-top:4px}
.pos-row{padding:12px 16px;border-bottom:1px solid var(--border);display:grid;grid-template-columns:80px 1fr auto;align-items:center;gap:12px}
.pos-row:last-child{border-bottom:none}
.pos-asset{font-family:var(--mono);font-size:14px;font-weight:500}
.pos-info{font-size:11px;color:var(--muted2)}
.pos-pnl{font-family:var(--mono);font-size:13px;font-weight:600;text-align:right}

/* BIST GRID */
.bist-grid{display:grid;grid-template-columns:1fr 1fr;gap:0}
.bist-item{padding:14px 16px;border-right:1px solid var(--border);border-bottom:1px solid var(--border)}
.bist-item:nth-child(2n){border-right:none}
.bist-item:nth-child(3),.bist-item:nth-child(4){border-bottom:none}
.bist-sym{font-family:var(--mono);font-size:11px;color:var(--muted);margin-bottom:4px;letter-spacing:1px}
.bist-price{font-size:20px;font-weight:700;font-family:var(--mono)}
.bist-chg{font-family:var(--mono);font-size:11px;margin-top:2px}

/* FNG */
.fng-circle{width:90px;height:90px;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;border:3px solid var(--border);transition:border-color 1s}
.fng-val{font-size:26px;font-weight:800;font-family:var(--mono);line-height:1}
.fng-sub{font-size:9px;color:var(--muted);letter-spacing:1px}
.fng-label{font-size:18px;font-weight:700;margin-bottom:4px}
.fng-bar{height:6px;background:linear-gradient(90deg,#ff4458,#ffb300,#00e676);border-radius:3px;position:relative;margin-top:12px}
.fng-needle{position:absolute;top:-5px;width:3px;height:16px;background:white;border-radius:2px;transform:translateX(-50%);box-shadow:0 0 8px white;transition:left 1.5s ease}

/* FON SIGNALS */
.fon-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:0}
.fon-item{padding:14px 16px;border-right:1px solid var(--border);border-bottom:1px solid var(--border)}
.fon-code{font-family:var(--mono);font-size:16px;font-weight:600;margin-bottom:4px}
.fon-text{font-size:11px;color:var(--muted2);line-height:1.5;margin-top:6px}

/* HISTORY */
.hrow{padding:10px 16px;border-bottom:1px solid var(--border);display:grid;grid-template-columns:70px 100px 1fr 90px 90px 90px;align-items:center;gap:10px;font-family:var(--mono);font-size:11px}
.hrow:last-child{border-bottom:none}
.hrow:hover{background:var(--panel2)}
.hhead{background:var(--panel2);font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:1px;padding:8px 16px}

/* EMPTY STATE */
.empty{padding:40px;text-align:center;color:var(--muted);font-family:var(--mono);font-size:12px;line-height:2}
.empty-icon{font-size:32px;margin-bottom:12px;opacity:.5}

/* EXPAND */
.expand-btn{width:100%;padding:10px;background:var(--panel2);border:none;border-top:1px solid var(--border);color:var(--muted);font-family:var(--mono);font-size:10px;cursor:pointer;transition:all .15s;letter-spacing:1px}
.expand-btn:hover{color:var(--accent);background:var(--bg2)}
.hidden-opps{display:none}
.hidden-opps.visible{display:block}

/* MISSED */
.missed-item{padding:12px 16px;border-bottom:1px solid var(--border);display:grid;grid-template-columns:80px 1fr auto;gap:10px;align-items:start}
.missed-item:last-child{border-bottom:none}
.missed-asset{font-family:var(--mono);font-size:13px;font-weight:600}
.missed-why{font-size:11px;color:var(--muted2);line-height:1.5}
.missed-gain{font-family:var(--mono);font-size:12px;font-weight:600;color:var(--buy);text-align:right}

/* LAYER BADGE */
.layer-badge{display:inline-flex;align-items:center;gap:3px;padding:2px 7px;border-radius:3px;font-size:9px;font-family:var(--mono);font-weight:600}
.layer-1{background:rgba(0,230,118,.08);color:var(--buy);border:1px solid rgba(0,230,118,.2)}
.layer-2{background:rgba(255,179,0,.08);color:var(--hold);border:1px solid rgba(255,179,0,.2)}
.layer-3{background:rgba(255,68,88,.08);color:var(--sell);border:1px solid rgba(255,68,88,.2)}

/* RR BADGE */
.rr{font-family:var(--mono);font-size:9px;padding:2px 7px;border-radius:3px;background:rgba(79,142,247,.1);border:1px solid rgba(79,142,247,.2);color:var(--accent)}

/* SECTION PADDING */
.section{padding:12px 0}
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div class="logo">
    <div class="logo-icon">ğŸ¯</div>
    <div>
      <div class="logo-text">FinSignal <span>2.0</span></div>
      <div class="logo-sub">FÄ±rsat YakalayÄ±cÄ± Â· Agent</div>
    </div>
  </div>
  <div class="hstats">
    <div class="hstat"><div class="hstat-val up" id="hBTC">â€”</div><div class="hstat-lbl">BTC</div></div>
    <div class="hstat"><div class="hstat-val" id="hETH" style="color:var(--accent)">â€”</div><div class="hstat-lbl">ETH</div></div>
    <div class="hstat"><div class="hstat-val" id="hSPX" style="color:var(--hold)">â€”</div><div class="hstat-lbl">S&P 500</div></div>
    <div class="hstat"><div class="hstat-val" id="hTHYAO" style="color:var(--purple)">â€”</div><div class="hstat-lbl">THYAO</div></div>
    <div class="hstat"><div class="hstat-val" id="hFNG">â€”</div><div class="hstat-lbl">F&G Index</div></div>
    <div class="live-badge"><span class="dot"></span><span id="updateTime">YÃ¼kleniyor</span></div>
  </div>
</div>

<!-- TICKER -->
<div class="ticker-wrap">
  <div class="ticker-track" id="ticker"><span style="color:var(--muted);font-family:var(--mono);font-size:11px;padding:0 20px">Veriler yÃ¼kleniyor...</span></div>
</div>

<!-- TABS -->
<div class="tabs-wrap">
  <div class="tabs">
    <button class="tab active" onclick="switchTab('opps',this)">ğŸ¯ FÄ±rsatlar</button>
    <button class="tab" onclick="switchTab('portfolio',this)">ğŸ’¼ PortfÃ¶y</button>
    <button class="tab" onclick="switchTab('market',this)">ğŸ“Š Piyasa</button>
    <button class="tab" onclick="switchTab('history',this)">ğŸ“‹ GeÃ§miÅŸ</button>
    <button class="tab" onclick="switchTab('watchlist',this)">ğŸ‘ Ä°zleme</button>
  </div>
</div>

<!-- â•â•â• TAB: FIRSATLAR â•â•â• -->
<div class="tab-content active" id="tab-opps">
<div class="wrap">
  <!-- KPI ROW -->
  <div class="g5">
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">Piyasa Duygusu</div>
        <div class="kpi-val" id="kSentiment" style="color:var(--hold)">â€”</div>
        <div class="gauge-track"><div class="gauge-needle" id="gaugeNeedle" style="left:50%"></div></div>
        <div class="kpi-sub" id="kSentimentSub">yÃ¼kleniyor</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">BugÃ¼nÃ¼n FÄ±rsatlarÄ±</div>
        <div class="kpi-val" style="color:var(--accent)" id="kOppCount">â€”</div>
        <div class="kpi-sub" id="kOppBreak">â€” yÃ¼ksek / â€” orta / â€” dÃ¼ÅŸÃ¼k</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">En Ä°yi FÄ±rsat</div>
        <div style="padding-top:4px;font-size:13px;color:var(--buy);line-height:1.6;font-weight:600" id="kTopOpp">YÃ¼kleniyor...</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">Ana Risk</div>
        <div style="padding-top:4px;font-size:13px;color:var(--sell);line-height:1.6" id="kRisk">YÃ¼kleniyor...</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">Agent Ã–zeti</div>
        <div style="padding-top:4px;font-size:11px;color:var(--muted2);line-height:1.7" id="kSummary">YÃ¼kleniyor...</div>
      </div>
    </div>
  </div>

  <!-- TOP 3 FIRSATLAR -->
  <div class="section">
    <div class="gmain" style="padding:0;gap:12px">
      <div>
        <div class="card">
          <div class="chead">
            <span class="ctitle">âš¡ BugÃ¼nÃ¼n En Ä°yi FÄ±rsatlarÄ±</span>
            <span class="cbadge" id="oppDate">â€”</span>
          </div>
          <div id="top3Feed">
            <div class="empty"><div class="empty-icon">ğŸ¯</div>FÄ±rsatlar yÃ¼kleniyor...</div>
          </div>
          <!-- DiÄŸer fÄ±rsatlar - gizli -->
          <div id="otherOpps" class="hidden-opps"></div>
          <button class="expand-btn" id="expandBtn" onclick="toggleOpps()" style="display:none">
            â–¼ DÄ°ÄER FIRSATLARI GÃ–STER (0)
          </button>
        </div>
      </div>

      <!-- SAÄ PANEL -->
      <div style="display:flex;flex-direction:column;gap:12px">
        <!-- PORTFÃ–Y Ã–ZET -->
        <div class="card">
          <div class="chead"><span class="ctitle">ğŸ’¼ PortfÃ¶y Ã–zeti</span><span class="cbadge">Sanal</span></div>
          <div style="padding:16px;display:flex;flex-direction:column;gap:10px">
            <div>
              <div style="font-size:9px;color:var(--muted);font-family:var(--mono);letter-spacing:2px;text-transform:uppercase;margin-bottom:4px">Toplam DeÄŸer</div>
              <div style="font-size:28px;font-weight:800;font-family:var(--mono)" id="pfTotal">$0</div>
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
              <div style="padding:10px;background:var(--panel2);border-radius:8px;border:1px solid var(--border)">
                <div style="font-size:9px;color:var(--muted);font-family:var(--mono);margin-bottom:2px">BUGÃœN</div>
                <div style="font-family:var(--mono);font-size:14px;font-weight:600" id="pfDaily">â€”</div>
              </div>
              <div style="padding:10px;background:var(--panel2);border-radius:8px;border:1px solid var(--border)">
                <div style="font-size:9px;color:var(--muted);font-family:var(--mono);margin-bottom:2px">TOPLAM</div>
                <div style="font-family:var(--mono);font-size:14px;font-weight:600" id="pfTotal2">â€”</div>
              </div>
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px">
              <div style="padding:8px;background:rgba(0,230,118,.05);border:1px solid rgba(0,230,118,.15);border-radius:6px;text-align:center">
                <div style="font-size:8px;color:var(--muted);font-family:var(--mono)">K1 GÃœVENLÄ°</div>
                <div style="font-family:var(--mono);font-size:12px;color:var(--buy);margin-top:2px" id="pfL1">$300</div>
              </div>
              <div style="padding:8px;background:rgba(255,179,0,.05);border:1px solid rgba(255,179,0,.15);border-radius:6px;text-align:center">
                <div style="font-size:8px;color:var(--muted);font-family:var(--mono)">K2 ORTA</div>
                <div style="font-family:var(--mono);font-size:12px;color:var(--hold);margin-top:2px" id="pfL2">$150</div>
              </div>
              <div style="padding:8px;background:rgba(255,68,88,.05);border:1px solid rgba(255,68,88,.15);border-radius:6px;text-align:center">
                <div style="font-size:8px;color:var(--muted);font-family:var(--mono)">K3 RÄ°SKLÄ°</div>
                <div style="font-family:var(--mono);font-size:12px;color:var(--sell);margin-top:2px" id="pfL3">$100</div>
              </div>
            </div>
          </div>
        </div>

        <!-- TEFAS FON -->
        <div class="card">
          <div class="chead"><span class="ctitle">ğŸ¦ TEFAS Fon Ã–nerileri</span><span class="cbadge">AI Analiz</span></div>
          <div id="fonSignals" class="fon-grid">
            <div class="empty" style="padding:20px">YÃ¼kleniyor...</div>
          </div>
          <div class="snote">AI analizi â€” yatÄ±rÄ±m tavsiyesi deÄŸildir</div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• TAB: PORTFÃ–Y â•â•â• -->
<div class="tab-content" id="tab-portfolio">
<div class="wrap">
  <div class="g3" style="padding:16px 0 12px">
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">Toplam DeÄŸer</div>
        <div class="kpi-val" style="color:var(--text)" id="pf2Total">$0</div>
        <div class="kpi-sub" id="pf2StartDate">BaÅŸlangÄ±Ã§: â€”</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">Toplam Getiri</div>
        <div class="kpi-val" id="pf2TotalReturn">â€”</div>
        <div class="kpi-sub" id="pf2MonthReturn">Bu ay: â€”</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">AÃ§Ä±k Pozisyonlar</div>
        <div class="kpi-val" style="color:var(--accent)" id="pf2OpenPos">0</div>
        <div class="kpi-sub" id="pf2ClosedTrades">KapatÄ±lan: 0 iÅŸlem</div>
      </div>
    </div>
  </div>

  <div class="g2" style="padding:0;gap:12px;padding-bottom:20px">
    <div class="card">
      <div class="chead"><span class="ctitle">ğŸ“ˆ AÃ§Ä±k Pozisyonlar</span><span class="cbadge" id="posCount">0 pozisyon</span></div>
      <div id="positionsFeed">
        <div class="empty"><div class="empty-icon">ğŸ’¼</div>HenÃ¼z aÃ§Ä±k pozisyon yok.<br>Agent fÄ±rsat bulunca buraya kaydeder.</div>
      </div>
    </div>
    <div class="card">
      <div class="chead"><span class="ctitle">ğŸ“Š Katman DaÄŸÄ±lÄ±mÄ±</span></div>
      <div style="padding:16px;display:flex;flex-direction:column;gap:12px">
        <div>
          <div style="display:flex;justify-content:space-between;margin-bottom:6px">
            <span style="font-size:11px;color:var(--buy);font-family:var(--mono)">K1 â€” GÃ¼venli (TEFAS)</span>
            <span style="font-family:var(--mono);font-size:11px" id="l1Pct">$300 / 54%</span>
          </div>
          <div style="height:6px;background:var(--border);border-radius:3px"><div id="l1Bar" style="height:100%;background:var(--buy);border-radius:3px;width:54%;transition:width 1s"></div></div>
        </div>
        <div>
          <div style="display:flex;justify-content:space-between;margin-bottom:6px">
            <span style="font-size:11px;color:var(--hold);font-family:var(--mono)">K2 â€” Orta (AltÄ±n/BTC)</span>
            <span style="font-family:var(--mono);font-size:11px" id="l2Pct">$150 / 27%</span>
          </div>
          <div style="height:6px;background:var(--border);border-radius:3px"><div id="l2Bar" style="height:100%;background:var(--hold);border-radius:3px;width:27%;transition:width 1s"></div></div>
        </div>
        <div>
          <div style="display:flex;justify-content:space-between;margin-bottom:6px">
            <span style="font-size:11px;color:var(--sell);font-family:var(--mono)">K3 â€” Riskli (Anomali)</span>
            <span style="font-family:var(--mono);font-size:11px" id="l3Pct">$100 / 18%</span>
          </div>
          <div style="height:6px;background:var(--border);border-radius:3px"><div id="l3Bar" style="height:100%;background:var(--sell);border-radius:3px;width:18%;transition:width 1s"></div></div>
        </div>
        <div style="padding-top:8px;border-top:1px solid var(--border)">
          <div style="font-size:9px;color:var(--muted);font-family:var(--mono);letter-spacing:1px;margin-bottom:8px">KATMAN KURALLARI</div>
          <div style="font-size:10px;color:var(--muted2);line-height:1.8;font-family:var(--mono)">
            K1: Her ay otomatik $300 â†’ TP2/PRY/YPT<br>
            K2: Trend + F&G sinyaline gÃ¶re â†’ stop -%10<br>
            K3: Anomali fÄ±rsatÄ± â†’ stop -%15 zorunlu
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• TAB: PÄ°YASA â•â•â• -->
<div class="tab-content" id="tab-market">
<div class="wrap">
  <div class="g2" style="padding:16px 0 12px;gap:12px">
    <!-- BIST -->
    <div class="card">
      <div class="chead"><span class="ctitle">ğŸ‡¹ğŸ‡· BIST Hisseleri</span><span class="cbadge" id="bistBadge">Yahoo Finance</span></div>
      <div class="bist-grid">
        <div class="bist-item">
          <div class="bist-sym">THYAO</div>
          <div class="bist-price" id="bTHYAO">â€”</div>
          <div class="bist-chg" id="bTHYAOc">â€”</div>
        </div>
        <div class="bist-item">
          <div class="bist-sym">GARAN</div>
          <div class="bist-price" id="bGARAN">â€”</div>
          <div class="bist-chg" id="bGARANc">â€”</div>
        </div>
        <div class="bist-item">
          <div class="bist-sym">ASELS</div>
          <div class="bist-price" id="bASELS">â€”</div>
          <div class="bist-chg" id="bASELSc">â€”</div>
        </div>
        <div class="bist-item">
          <div class="bist-sym">EREGL</div>
          <div class="bist-price" id="bEREGL">â€”</div>
          <div class="bist-chg" id="bEREGLc">â€”</div>
        </div>
      </div>
    </div>

    <!-- FEAR & GREED -->
    <div class="card">
      <div class="chead"><span class="ctitle">ğŸ˜¨ Fear & Greed Index</span><span class="cbadge">alternative.me</span></div>
      <div style="padding:20px;display:flex;align-items:center;gap:24px">
        <div class="fng-circle" id="fngCircle">
          <div class="fng-val" id="fngVal">â€”</div>
          <div class="fng-sub">/100</div>
        </div>
        <div style="flex:1">
          <div class="fng-label" id="fngLabel">â€”</div>
          <div style="font-size:11px;color:var(--muted2);line-height:2;font-family:var(--mono)">
            0-24: AÅŸÄ±rÄ± Korku ğŸ”´<br>
            25-49: Korku ğŸŸ <br>
            50-74: AÃ§gÃ¶zlÃ¼lÃ¼k ğŸŸ¡<br>
            75-100: AÅŸÄ±rÄ± AÃ§gÃ¶zlÃ¼lÃ¼k ğŸŸ¢
          </div>
          <div class="fng-bar" style="margin-top:14px"><div class="fng-needle" id="fngNeedle" style="left:50%"></div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- KRÄ°PTO + ETF -->
  <div class="g2" style="padding:0;gap:12px;padding-bottom:12px">
    <div class="card">
      <div class="chead"><span class="ctitle">ğŸª™ Kripto FiyatlarÄ±</span><span class="cbadge">CoinGecko</span></div>
      <div id="cryptoFeed">
        <div class="empty" style="padding:20px">YÃ¼kleniyor...</div>
      </div>
    </div>
    <div class="card">
      <div class="chead"><span class="ctitle">ğŸ“ˆ ETF & Hisse</span><span class="cbadge">Yahoo Finance</span></div>
      <div id="etfFeed">
        <div class="empty" style="padding:20px">YÃ¼kleniyor...</div>
      </div>
    </div>
  </div>

  <!-- TREND COINLER -->
  <div class="card" style="margin-bottom:20px">
    <div class="chead"><span class="ctitle">ğŸ”¥ Trend VarlÄ±klar</span><span class="cbadge">CoinGecko</span></div>
    <div id="trendFeed" style="display:flex;flex-wrap:wrap;gap:8px;padding:12px 16px">
      <div style="color:var(--muted);font-family:var(--mono);font-size:11px">YÃ¼kleniyor...</div>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• TAB: GEÃ‡MÄ°Å â•â•â• -->
<div class="tab-content" id="tab-history">
<div class="wrap" style="padding-bottom:20px">
  <!-- PERFORMANS Ã–ZET -->
  <div class="g3" style="padding:16px 0 12px">
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">Toplam Karar</div>
        <div class="kpi-val" style="color:var(--accent)" id="hTotalDecisions">0</div>
        <div class="kpi-sub" id="hPeriod">Sistem baÅŸlangÄ±cÄ±ndan</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">DoÄŸruluk OranÄ±</div>
        <div class="kpi-val" id="hAccuracy">â€”</div>
        <div class="kpi-sub" id="hCorrectWrong">â€” doÄŸru / â€” yanlÄ±ÅŸ</div>
      </div>
    </div>
    <div class="card">
      <div class="kpi">
        <div class="kpi-lbl">Ortalama Getiri</div>
        <div class="kpi-val" id="hAvgReturn">â€”</div>
        <div class="kpi-sub">SonuÃ§lanan sinyaller</div>
      </div>
    </div>
  </div>

  <!-- KARAR GEÃ‡MÄ°ÅÄ° -->
  <div class="card" style="margin-bottom:12px">
    <div class="chead"><span class="ctitle">ğŸ“‹ Karar GeÃ§miÅŸi</span><span class="cbadge">history.json</span></div>
    <div class="hrow hhead" style="font-size:9px">
      <span>Tarih</span><span>VarlÄ±k</span><span>Analiz</span><span>GiriÅŸ</span><span>Ã‡Ä±kÄ±ÅŸ</span><span>SonuÃ§</span>
    </div>
    <div id="historyFeed">
      <div class="empty">
        <div class="empty-icon">ğŸ“Š</div>
        HenÃ¼z sonuÃ§lanan karar yok<br>
        <span style="color:var(--accent)">7 gÃ¼n sonra ilk sonuÃ§lar hesaplanacak</span>
      </div>
    </div>
  </div>

  <!-- NEDEN KAÃ‡IRDIM -->
  <div class="card">
    <div class="chead"><span class="ctitle">ğŸ” Neden KaÃ§Ä±rdÄ±m?</span><span class="cbadge">Agent Analizi</span></div>
    <div id="missedFeed">
      <div class="empty">
        <div class="empty-icon">ğŸ”</div>
        GeÃ§miÅŸ karar analizi henÃ¼z yok<br>
        <span style="color:var(--muted2);font-size:10px">Agent dÃ¼nkÃ¼ ve geÃ§en haftaki hareketleri analiz edecek</span>
      </div>
    </div>
  </div>
</div>
</div>

<!-- â•â•â• TAB: Ä°ZLEME â•â•â• -->
<div class="tab-content" id="tab-watchlist">
<div class="wrap" style="padding-bottom:20px">
  <div style="padding:16px 0 12px">
    <div class="card">
      <div class="chead">
        <span class="ctitle">ğŸ‘ Ä°zleme Listesi</span>
        <span class="cbadge">HenÃ¼z sinyal yok â€” tetikleyici bekleniyor</span>
      </div>
      <div id="watchFeed">
        <div class="empty">
          <div class="empty-icon">ğŸ‘</div>
          Ä°zleme listesi yÃ¼kleniyor...<br>
          <span style="color:var(--muted2);font-size:10px">Agent compression/sÄ±kÄ±ÅŸma pattern'larÄ± burada gÃ¶sterir</span>
        </div>
      </div>
      <div class="snote">ğŸ“Œ Bu varlÄ±klar henÃ¼z sinyal Ã¼retmedi. Trigger seviyesine ulaÅŸÄ±nca fÄ±rsat listesine taÅŸÄ±nÄ±r.</div>
    </div>
  </div>
</div>
</div>

<script>
function switchTab(id,btn){
  document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('tab-'+id).classList.add('active');
  btn.classList.add('active');
}

function getLabelTR(v){
  if(v<=24) return 'AÅŸÄ±rÄ± Korku';
  if(v<=49) return 'Korku';
  if(v<=74) return 'AÃ§gÃ¶zlÃ¼lÃ¼k';
  return 'AÅŸÄ±rÄ± AÃ§gÃ¶zlÃ¼lÃ¼k';
}

function getTypeLabel(t){
  if(t==='BULL'||t==='BUY') return {l:'AL',cls:'tag-buy'};
  if(t==='BEAR'||t==='SELL') return {l:'SAT',cls:'tag-sell'};
  return {l:'BEKLE',cls:'tag-hold'};
}

function getLayerBadge(l){
  if(l===1) return '<span class="layer-badge layer-1">K1 GÃœVENLÄ°</span>';
  if(l===2) return '<span class="layer-badge layer-2">K2 ORTA</span>';
  return '<span class="layer-badge layer-3">K3 RÄ°SKLÄ°</span>';
}

function renderScoreBar(score){
  let dots='';
  for(let i=0;i<10;i++){
    const filled=i<score;
    const high=score>=7&&filled;
    dots+=`<div class="score-dot${filled?' filled':''}${high?' high':''}"></div>`;
  }
  return `<div class="score-bar">${dots}</div><div style="font-size:9px;color:var(--muted);font-family:var(--mono);text-align:right;margin-top:2px">${score}/10</div>`;
}

function renderOppCard(o){
  const tl=getTypeLabel(o.type);
  const layer=getLayerBadge(o.layer||3);
  const pattern=o.pattern||'VOLUME';
  const rr=o.riskReward||'â€”';
  return `<div class="opp-card">
    <div class="opp-top">
      <div>
        <div class="opp-asset">${o.asset} <span class="tag ${tl.cls}" style="font-size:10px;vertical-align:middle">${tl.l}</span></div>
        <div style="display:flex;align-items:center;gap:6px;margin-top:4px">
          <span class="opp-pattern">â—† ${pattern}</span>
          ${layer}
          <span class="rr">R/R ${rr}</span>
        </div>
      </div>
      <div class="opp-score">${renderScoreBar(o.score||5)}</div>
    </div>
    <div class="opp-text">${o.text||'â€”'}</div>
    <div class="opp-targets">
      <div class="tbox tbox-entry"><div class="tbox-lbl">GiriÅŸ</div><div class="tbox-val">${o.entry||'â€”'}</div></div>
      <div class="tbox tbox-target"><div class="tbox-lbl">Hedef</div><div class="tbox-val">${o.target||'â€”'}</div></div>
      <div class="tbox tbox-stop"><div class="tbox-lbl">Stop</div><div class="tbox-val">${o.stopLoss||'â€”'}</div></div>
    </div>
    <div class="opp-footer">
      <span class="opp-meta">${o.timeframe||'â€”'} Â· ${o.confidence||'â€”'} gÃ¼ven</span>
      <span class="opp-amount">Ã–neri: ${o.suggestedAmount||'â€”'}</span>
    </div>
  </div>`;
}

function toggleOpps(){
  const el=document.getElementById('otherOpps');
  const btn=document.getElementById('expandBtn');
  const visible=el.classList.toggle('visible');
  btn.textContent=visible?'â–² DAHA AZ GÃ–STER':'â–¼ DÄ°ÄER FIRSATLARI GÃ–STER';
}

// DATA.JSON FETCH
fetch('data.json?t='+Date.now())
  .then(r=>r.json())
  .then(data=>{
    document.getElementById('updateTime').textContent=data.lastUpdate||'â€”';
    document.getElementById('oppDate').textContent=data.date||'â€”';

    // SENTIMENT
    const sent=data.marketSentiment||'NEUTRAL';
    const sc=sent==='BULLISH'?'var(--buy)':sent==='BEARISH'?'var(--sell)':'var(--hold)';
    const sentTR=sent==='BULLISH'?'YÃœKSELÄ°Å':sent==='BEARISH'?'DÃœÅÃœÅ':'NÃ–TR';
    document.getElementById('kSentiment').textContent=sentTR;
    document.getElementById('kSentiment').style.color=sc;
    document.getElementById('kSentimentSub').textContent='Skor: '+(data.sentimentScore||50)+'/100';
    document.getElementById('gaugeNeedle').style.left=(data.sentimentScore||50)+'%';
    document.getElementById('kSummary').textContent=data.summary||'â€”';
    document.getElementById('kTopOpp').textContent=data.topOpportunity||'â€”';
    document.getElementById('kRisk').textContent=data.topRisk||'â€”';

    // FÄ°YATLAR â€” HEADER
    const p=data.prices||{};
    if(p.btc){
      const hb=document.getElementById('hBTC');
      hb.textContent='$'+Number(p.btc.price||0).toLocaleString();
      hb.className='hstat-val '+(p.btc.change24h>=0?'up':'dn');
    }
    if(p.eth) document.getElementById('hETH').textContent='$'+Number(p.eth.price||0).toLocaleString();
    if(data.stocks?.spx) document.getElementById('hSPX').textContent=Number(data.stocks.spx).toFixed(0);

    // KRÄ°PTO FEED
    const cryptoEl=document.getElementById('cryptoFeed');
    if(p.btc||p.eth){
      const coins=[
        {sym:'BTC',icon:'â‚¿',price:p.btc?.price,chg:p.btc?.change24h},
        {sym:'ETH',icon:'Î',price:p.eth?.price,chg:p.eth?.change24h},
        {sym:'SOL',icon:'â—',price:p.sol?.price,chg:p.sol?.change24h},
        {sym:'XRP',icon:'âœ•',price:p.xrp?.price,chg:p.xrp?.change24h},
      ];
      cryptoEl.innerHTML=coins.map(c=>`
        <div style="padding:12px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between">
          <div style="display:flex;align-items:center;gap:10px">
            <span style="font-size:16px;width:24px;text-align:center">${c.icon}</span>
            <span style="font-family:var(--mono);font-weight:600">${c.sym}</span>
          </div>
          <div style="text-align:right">
            <div style="font-family:var(--mono);font-size:14px;font-weight:500">$${Number(c.price||0).toLocaleString()}</div>
            <div style="font-family:var(--mono);font-size:11px" class="${(c.chg||0)>=0?'up':'dn'}">${(c.chg||0)>=0?'+':''}${Number(c.chg||0).toFixed(2)}%</div>
          </div>
        </div>`).join('');
    }

    // BIST
    if(data.bist){
      const b=data.bist;
      [['thyao','THYAO'],['garan','GARAN'],['asels','ASELS'],['eregl','EREGL']].forEach(([k,sym])=>{
        const v=b[k];if(!v)return;
        const pe=document.getElementById('b'+sym);
        const pc=document.getElementById('b'+sym+'c');
        if(pe) pe.textContent=Number(v.price||0).toFixed(2)+'â‚º';
        if(pc){pc.textContent=(v.change>=0?'+':'')+Number(v.change||0).toFixed(2)+'%';pc.className='bist-chg '+(v.change>=0?'up':'dn');}
      });
      if(b.thyao){
        const ht=document.getElementById('hTHYAO');
        ht.textContent=Number(b.thyao.price||0).toFixed(2)+'â‚º';
        ht.className='hstat-val '+(b.thyao.change>=0?'up':'dn');
      }
    }

    // FEAR & GREED
    if(data.fearGreed){
      const fg=data.fearGreed;
      const val=fg.value||50;
      let fgColor='var(--hold)';
      if(val<=24) fgColor='var(--sell)';
      else if(val<=49) fgColor='#e06c00';
      else if(val>=75) fgColor='var(--buy)';
      document.getElementById('fngVal').textContent=val;
      const lbl=getLabelTR(val);
      document.getElementById('fngLabel').textContent=lbl;
      document.getElementById('fngLabel').style.color=fgColor;
      document.getElementById('fngCircle').style.borderColor=fgColor;
      document.getElementById('fngNeedle').style.left=val+'%';
      const hf=document.getElementById('hFNG');
      hf.textContent=val+' '+lbl;
      hf.style.color=fgColor;
    }

    // TICKER
    const bist=data.bist||{};
    const ticks=[
      {s:'BTC',p:'$'+Number(p.btc?.price||0).toLocaleString(),c:p.btc?.change24h||0},
      {s:'ETH',p:'$'+Number(p.eth?.price||0).toLocaleString(),c:p.eth?.change24h||0},
      {s:'SOL',p:'$'+Number(p.sol?.price||0).toLocaleString(),c:p.sol?.change24h||0},
      {s:'XRP',p:'$'+Number(p.xrp?.price||0).toLocaleString(),c:p.xrp?.change24h||0},
      {s:'S&P500',p:data.stocks?.spx?Number(data.stocks.spx).toFixed(0):'â€”',c:data.stocks?.spxChange||0},
      {s:'THYAO',p:bist.thyao?Number(bist.thyao.price).toFixed(2)+'â‚º':'â€”',c:bist.thyao?.change||0},
      {s:'GARAN',p:bist.garan?Number(bist.garan.price).toFixed(2)+'â‚º':'â€”',c:bist.garan?.change||0},
      {s:'ASELS',p:bist.asels?Number(bist.asels.price).toFixed(2)+'â‚º':'â€”',c:bist.asels?.change||0},
      {s:'F&G',p:(data.fearGreed?.value||'â€”')+'/100',c:0},
    ];
    document.getElementById('ticker').innerHTML=[...ticks,...ticks].map(t=>
      `<span class="tick"><span class="tick-sym">${t.s}</span><span class="tick-price">${t.p}</span>${t.c!==0?`<span class="${t.c>=0?'up':'dn'}">${t.c>=0?'+':''}${Number(t.c).toFixed(2)}%</span>`:''}</span><span class="tick-sep">Â·</span>`
    ).join('');

    // TREND COINLER
    if(data.trendingCoins?.length){
      document.getElementById('trendFeed').innerHTML=data.trendingCoins.map((c,i)=>
        `<span style="padding:5px 12px;background:var(--panel2);border:1px solid var(--border);border-radius:6px;font-family:var(--mono);font-size:11px;color:var(--muted2)"><span style="color:var(--muted);margin-right:4px">#${i+1}</span>${c}</span>`
      ).join('');
    }

    // FIRSATLAR â€” opportunities veya signals'tan Ã¼ret
    const opps = data.opportunities || [];
    const signals = data.signals || [];
    const fonKodlari=['YPT','YLB','YVD','YKT','YZG','YTD','TP2','PRY','HVT','PPT','PAB','PPI'];

    // Fon sinyalleri
    const fonSigs=signals.filter(s=>fonKodlari.includes(s.asset));
    const fonEl=document.getElementById('fonSignals');
    if(fonSigs.length>0){
      fonEl.innerHTML=fonSigs.map(s=>{
        const tl=getTypeLabel(s.type);
        const bg=s.type==='BULL'||s.type==='BUY'?'rgba(0,230,118,.05)':s.type==='BEAR'||s.type==='SELL'?'rgba(255,68,88,.05)':'rgba(255,179,0,.05)';
        return `<div class="fon-item" style="background:${bg}">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <span class="fon-code">${s.asset}</span>
            <span class="tag ${tl.cls}">${tl.l}</span>
          </div>
          <div class="fon-text">${s.text}</div>
        </div>`;
      }).join('');
    } else {
      fonEl.innerHTML='<div class="empty" style="padding:20px">Fon sinyali yÃ¼kleniyor...</div>';
    }

    // Ana fÄ±rsatlar - opportunities varsa kullan, yoksa signals'tan filtrele
    let mainOpps=opps.length>0 ? opps : signals.filter(s=>!fonKodlari.includes(s.asset));

    // Skor ile sÄ±rala
    mainOpps=mainOpps.sort((a,b)=>(b.score||0)-(a.score||0));

    const top3=mainOpps.slice(0,3);
    const others=mainOpps.slice(3,13);

    // SayÄ±lar
    const high=mainOpps.filter(o=>(o.score||0)>=7).length;
    const med=mainOpps.filter(o=>(o.score||0)>=4&&(o.score||0)<7).length;
    const low=mainOpps.filter(o=>(o.score||0)<4).length;
    document.getElementById('kOppCount').textContent=mainOpps.length;
    document.getElementById('kOppBreak').textContent=`${high} yÃ¼ksek / ${med} orta / ${low} dÃ¼ÅŸÃ¼k`;

    // Top 3
    const top3El=document.getElementById('top3Feed');
    if(top3.length>0){
      top3El.innerHTML=top3.map(o=>renderOppCard(o)).join('');
    } else {
      top3El.innerHTML='<div class="empty"><div class="empty-icon">ğŸ¯</div>BugÃ¼n yÃ¼ksek skorlu fÄ±rsat bulunamadÄ±</div>';
    }

    // DiÄŸerleri
    const otherEl=document.getElementById('otherOpps');
    const expandBtn=document.getElementById('expandBtn');
    if(others.length>0){
      otherEl.innerHTML=others.map(o=>renderOppCard(o)).join('');
      expandBtn.style.display='block';
      expandBtn.textContent=`â–¼ DÄ°ÄER FIRSATLARI GÃ–STER (${others.length})`;
    }

    // ETF FEED â€” stocks varsa gÃ¶ster
    const etfEl=document.getElementById('etfFeed');
    if(data.stocks||data.etf){
      const etfs=[
        {sym:'SPY',name:'S&P 500 ETF',val:data.stocks?.spx,chg:data.stocks?.spxChange},
        {sym:'QQQ',name:'Nasdaq ETF',val:data.etf?.qqq?.price,chg:data.etf?.qqq?.change},
        {sym:'GDX',name:'Gold Miners ETF',val:data.etf?.gdx?.price,chg:data.etf?.gdx?.change},
        {sym:'XLE',name:'Energy ETF',val:data.etf?.xle?.price,chg:data.etf?.xle?.change},
        {sym:'ILF',name:'Latin America ETF',val:data.etf?.ilf?.price,chg:data.etf?.ilf?.change},
      ].filter(e=>e.val);
      if(etfs.length>0){
        etfEl.innerHTML=etfs.map(e=>`
          <div style="padding:12px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between">
            <div>
              <div style="font-family:var(--mono);font-weight:600;font-size:13px">${e.sym}</div>
              <div style="font-size:10px;color:var(--muted)">${e.name}</div>
            </div>
            <div style="text-align:right">
              <div style="font-family:var(--mono);font-size:13px">$${Number(e.val).toFixed(2)}</div>
              ${e.chg?`<div style="font-family:var(--mono);font-size:10px" class="${e.chg>=0?'up':'dn'}">${e.chg>=0?'+':''}${Number(e.chg).toFixed(2)}%</div>`:''}
            </div>
          </div>`).join('');
      } else {
        etfEl.innerHTML='<div class="empty" style="padding:20px">ETF verisi yÃ¼kleniyor...</div>';
      }
    }

  })
  .catch(err=>{
    console.error('data.json yÃ¼klenemedi:',err);
    document.getElementById('top3Feed').innerHTML='<div class="empty">âš ï¸ Veri baÄŸlantÄ±sÄ± kurulamadÄ±</div>';
  });

// PORTFOLIO.JSON FETCH
fetch('portfolio.json?t='+Date.now())
  .then(r=>r.json())
  .then(pf=>{
    const total=pf.totalValue||0;
    const deposited=pf.totalDeposited||550;
    const returnPct=deposited>0?((total-deposited)/deposited*100):0;
    const daily=pf.dailyChange||0;
    const dailyPct=pf.dailyChangePct||0;

    // Header & fÄ±rsatlar sekmesi
    document.getElementById('pfTotal').textContent='$'+Number(total||550).toLocaleString();
    const dailyEl=document.getElementById('pfDaily');
    dailyEl.textContent=(daily>=0?'+':'')+daily.toFixed(2)+'$';
    dailyEl.className=daily>=0?'up':'dn';
    document.getElementById('pfTotal2').textContent=(returnPct>=0?'+':'')+returnPct.toFixed(1)+'%';

    const l1=pf.cash?.layer1||300;
    const l2=pf.cash?.layer2||150;
    const l3=pf.cash?.layer3||100;
    document.getElementById('pfL1').textContent='$'+l1;
    document.getElementById('pfL2').textContent='$'+l2;
    document.getElementById('pfL3').textContent='$'+l3;

    // PortfÃ¶y sekmesi
    document.getElementById('pf2Total').textContent='$'+Number(total||550).toLocaleString();
    document.getElementById('pf2StartDate').textContent='BaÅŸlangÄ±Ã§: '+(pf.startDate||'â€”');
    const tr=document.getElementById('pf2TotalReturn');
    tr.textContent=(returnPct>=0?'+':'')+returnPct.toFixed(1)+'%';
    tr.style.color=returnPct>=0?'var(--buy)':'var(--sell)';
    document.getElementById('pf2MonthReturn').textContent='Bu ay: '+(pf.monthlyReturn>=0?'+':'')+((pf.monthlyReturn||0).toFixed(1))+'%';

    const positions=pf.positions||[];
    document.getElementById('pf2OpenPos').textContent=positions.length;
    document.getElementById('pf2ClosedTrades').textContent='KapatÄ±lan: '+(pf.closedTrades?.length||0)+' iÅŸlem';
    document.getElementById('posCount').textContent=positions.length+' pozisyon';

    if(positions.length>0){
      document.getElementById('positionsFeed').innerHTML=positions.map(pos=>{
        const pnl=pos.currentPnlPct||0;
        return `<div class="pos-row">
          <div class="pos-asset">${pos.asset}</div>
          <div>
            <div class="pos-info">GiriÅŸ: $${pos.entryPrice||'â€”'} Â· ${pos.date||'â€”'}</div>
            <div class="pos-info">Hedef: ${pos.target||'â€”'} Â· Stop: ${pos.stopLoss||'â€”'}</div>
          </div>
          <div class="pos-pnl ${pnl>=0?'up':'dn'}">${pnl>=0?'+':''}${pnl.toFixed(1)}%</div>
        </div>`;
      }).join('');
    }

    // Katman barlarÄ±
    const totalVal=l1+l2+l3;
    document.getElementById('l1Pct').textContent='$'+l1+' / '+Math.round(l1/totalVal*100)+'%';
    document.getElementById('l2Pct').textContent='$'+l2+' / '+Math.round(l2/totalVal*100)+'%';
    document.getElementById('l3Pct').textContent='$'+l3+' / '+Math.round(l3/totalVal*100)+'%';
    document.getElementById('l1Bar').style.width=Math.round(l1/totalVal*100)+'%';
    document.getElementById('l2Bar').style.width=Math.round(l2/totalVal*100)+'%';
    document.getElementById('l3Bar').style.width=Math.round(l3/totalVal*100)+'%';
  })
  .catch(()=>{
    document.getElementById('pfTotal').textContent='$550';
    document.getElementById('pf2Total').textContent='$550';
  });

// HISTORY.JSON FETCH
fetch('history.json?t='+Date.now())
  .then(r=>r.json())
  .then(hist=>{
    const signals=hist.signals||[];
    const checked=signals.filter(s=>s.resultChecked);
    const pending=signals.filter(s=>!s.resultChecked);

    document.getElementById('hTotalDecisions').textContent=signals.length;
    document.getElementById('hPeriod').textContent=pending.length+' bekliyor, '+checked.length+' sonuÃ§landÄ±';

    if(checked.length>0){
      const correct=checked.filter(s=>s.result==='CORRECT').length;
      const accPct=Math.round(correct/checked.length*100);
      const avgRet=checked.reduce((a,s)=>a+(s.resultPct||0),0)/checked.length;
      const acc=document.getElementById('hAccuracy');
      acc.textContent=accPct+'%';
      acc.style.color=accPct>=60?'var(--buy)':accPct>=40?'var(--hold)':'var(--sell)';
      document.getElementById('hCorrectWrong').textContent=correct+' doÄŸru / '+(checked.length-correct)+' yanlÄ±ÅŸ';
      const ar=document.getElementById('hAvgReturn');
      ar.textContent=(avgRet>=0?'+':'')+avgRet.toFixed(1)+'%';
      ar.style.color=avgRet>=0?'var(--buy)':'var(--sell)';

      document.getElementById('historyFeed').innerHTML=checked.slice().reverse().map(s=>{
        const d=new Date(s.date);
        const tarih=d.toLocaleDateString('tr-TR',{day:'numeric',month:'short'});
        const tl=getTypeLabel(s.type);
        const pct=s.resultPct;
        const pctStr=pct!==null?(pct>=0?'+':'')+pct+'% '+(s.result==='CORRECT'?'âœ“':'âœ—'):'â€”';
        const entryP=s.entryPrices?.[s.asset?.toLowerCase()]||0;
        return `<div class="hrow">
          <span style="color:var(--muted)">${tarih}</span>
          <span style="font-family:var(--mono);font-weight:600">${s.asset}</span>
          <span style="font-size:10px;color:var(--muted2)">${s.text?.substring(0,60)||'â€”'}...</span>
          <span style="font-family:var(--mono)">${entryP?'$'+Number(entryP).toLocaleString():'â€”'}</span>
          <span style="font-family:var(--mono)">${s.exitPrice?'$'+Number(s.exitPrice).toLocaleString():'â€”'}</span>
          <span class="${s.result==='CORRECT'?'up':'dn'};font-family:var(--mono)">${pctStr}</span>
        </div>`;
      }).join('');
    }

    // NEDEN KAÃ‡IRDIM
    const missed=signals.filter(s=>s.missedReason);
    if(missed.length>0){
      document.getElementById('missedFeed').innerHTML=missed.slice().reverse().map(s=>{
        const gain=s.actualMove||0;
        return `<div class="missed-item">
          <div>
            <div class="missed-asset">${s.asset}</div>
            <div style="font-size:9px;color:var(--muted);font-family:var(--mono)">${new Date(s.date).toLocaleDateString('tr-TR')}</div>
          </div>
          <div class="missed-why">${s.missedReason}</div>
          <div class="missed-gain ${gain>=0?'up':'dn'}">${gain>=0?'+':''}${gain}%</div>
        </div>`;
      }).join('');
    }

    // Ä°ZLEME LÄ°STESÄ°
    const watchlist=hist.watchlist||[];
    if(watchlist.length>0){
      document.getElementById('watchFeed').innerHTML=watchlist.map(w=>`
        <div class="watch-item">
          <div>
            <div class="watch-asset">${w.asset}</div>
            <div class="watch-reason">${w.reason}</div>
          </div>
          <div class="watch-trigger">âš¡ ${w.triggerLevel}</div>
        </div>`).join('');
    }
  })
  .catch(()=>console.log('history.json henÃ¼z yok'));
</script>
</body>
</html>
